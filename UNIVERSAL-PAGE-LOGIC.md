# Universal Page Logic for PDF Generation

## üéØ **–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ –¥–ª—è –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫**

### üìã **–ö–ª—é—á–æ–≤–∞ –∑–º—ñ–Ω–∞:**

–§—É–Ω–∫—Ü—ñ—è `markBreakBefore()` —Ç–µ–ø–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î, —á–∏ —Ü–µ –ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞:

```javascript
const existingMarkers = flowRoot.querySelectorAll('.pdf-page-break-marker');
const isFirstPage = existingMarkers.length === 0;
```

### üé® **–õ–æ–≥—ñ–∫–∞ –≤—ñ–¥—Å—Ç—É–ø—ñ–≤:**

#### **–ü–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞:**
- **–ú–∞—Ä–∫–µ—Ä:** `height: 0px` (–Ω–µ–º–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –≤—ñ–¥—Å—Ç—É–ø—É)
- **–ë–ª–æ–∫:** `padding-top: 0px` (—Ç—ñ–ª—å–∫–∏ –≤—ñ–¥—Å—Ç—É–ø –∑ —à–∞–±–ª–æ–Ω—É)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –≤—ñ–¥—Å—Ç—É–ø –∑ —à–∞–±–ª–æ–Ω—É

#### **–Ü–Ω—à—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏:**
- **–ú–∞—Ä–∫–µ—Ä:** `height: 60px` (–¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –≤—ñ–¥—Å—Ç—É–ø)
- **–ë–ª–æ–∫:** `padding-top: 60px` (–≤—ñ–¥—Å—Ç—É–ø –¥–ª—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤—ñ–¥—Å—Ç—É–ø –¥–ª—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∏—Ö –±–ª–æ–∫—ñ–≤

### üîÑ **–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:**

```javascript
const markBreakBefore = (node: HTMLElement) => {
  // 1. –í–∏–∑–Ω–∞—á–∞—î–º–æ, —á–∏ —Ü–µ –ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞
  const existingMarkers = flowRoot.querySelectorAll('.pdf-page-break-marker');
  const isFirstPage = existingMarkers.length === 0;
  
  // 2. –°—Ç–≤–æ—Ä—é—î–º–æ –º–∞—Ä–∫–µ—Ä –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –≤–∏—Å–æ—Ç–æ—é
  marker.style.height = isFirstPage ? '0px' : `${pageTopGapPx}px`;
  
  // 3. –î–æ–¥–∞—î–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π padding –¥–æ –±–ª–æ–∫—É
  node.style.paddingTop = isFirstPage ? '0px' : `${pageTopGapPx}px`;
};
```

### üé® **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è:**

#### **–ö–æ–ª—å–æ—Ä–∏ –±–ª–æ–∫—ñ–≤:**
- üü¢ **–ó–µ–ª–µ–Ω–∏–π** - –±–ª–æ–∫–∏, —â–æ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—å—Å—è (direct pass)
- üî¥ **–ß–µ—Ä–≤–æ–Ω–∏–π** - –±–ª–æ–∫–∏, —â–æ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è (direct pass)
- üîµ **–°–∏–Ω—ñ–π** - –±–ª–æ–∫–∏, —â–æ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—å—Å—è –∑ –º–µ–∂—ñ (boundary pass)
- üü† **–ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∏–π** - –±–ª–æ–∫–∏, —â–æ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –Ω–∞ –º–µ–∂—ñ (boundary pass)

#### **–ö–æ–ª—å–æ—Ä–∏ –º–µ–∂:**
- üîµ **–°–∏–Ω—ñ–π** - –º–µ–∂—ñ —Å—Ç–æ—Ä—ñ–Ω–æ–∫
- üü¢ **–ó–µ–ª–µ–Ω–∏–π** - –º–µ–∂–∞ –±–µ–∑–ø–µ—á–Ω–æ—ó –∑–æ–Ω–∏
- üü° **–ñ–æ–≤—Ç–∏–π** - –º–µ–∂–∞ –¥–ª—è boundary analysis

### üìä **–õ–æ–≥—É–≤–∞–Ω–Ω—è:**

```javascript
pdfLog(traceId, 'debug:break-marker-created', {
  tagName: node.tagName,
  isFirstPage,
  markerHeight: isFirstPage ? 0 : pageTopGapPx,
  paddingTop: isFirstPage ? 0 : pageTopGapPx
});
```

### ‚úÖ **–ü–µ—Ä–µ–≤–∞–≥–∏:**

1. **–Ñ–¥–∏–Ω–∞ –ª–æ–≥—ñ–∫–∞** –¥–ª—è –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è** –ø–µ—Ä—à–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥—Å—Ç—É–ø–∏** - –ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö
4. **–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ—Å—Ç—å** - –ø—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–∏–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏
5. **–î–µ—Ç–∞–ª—å–Ω–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ø–æ–≤–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É

### üß™ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**

1. **–°—Ç–≤–æ—Ä—ñ—Ç—å –¥–æ–≤–≥–µ CV** (3+ —Å—Ç–æ—Ä—ñ–Ω–∫–∏)
2. **–ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ PDF**
3. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:**
   ```
   [PDF] debug:break-marker-created {isFirstPage: true, markerHeight: 0}
   [PDF] debug:break-marker-created {isFirstPage: false, markerHeight: 60}
   ```
4. **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é:**
   - –ü–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞: –∑–µ–ª–µ–Ω—ñ/—á–µ—Ä–≤–æ–Ω—ñ –±–ª–æ–∫–∏
   - –Ü–Ω—à—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏: —Å–∏–Ω—ñ/–ø–æ–º–∞—Ä–∞–Ω—á–µ–≤—ñ –±–ª–æ–∫–∏ + –∂–æ–≤—Ç—ñ –º–µ–∂—ñ

### üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–µ–ø–µ—Ä —É –≤–∞—Å —î:
- **–£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞** –¥–ª—è –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫
- **–ü—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥—Å—Ç—É–ø–∏** - –ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ —è–∫ —É —à–∞–±–ª–æ–Ω—ñ
- **–ü–æ–≤–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è** –ø—Ä–æ—Ü–µ—Å—É –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è
- **–î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è** –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –ª–æ–≥—ñ–∫–∏ –≤–∏—Ä—ñ—à–µ–Ω–∞!** üöÄ
